<!-- Estrutura Principal da Tela -->
<div class="p-4 sm:p-8 min-h-screen flex items-start justify-center">
  <div class="w-full max-w-lg">
    
    <h1 class="text-3xl font-bold mb-6 text-center text-white">Nova Transação</h1>

    <!-- Mensagem de Sucesso (Condicional) -->
    @if (isTransactionSuccessful()) {
      <div class="bg-emerald-600/20 text-emerald-300 p-4 rounded-xl mb-6 flex items-center justify-center border border-emerald-500 transition-all duration-300">
        <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
        <p class="font-semibold">Transação realizada com sucesso!</p>
      </div>
    }

    <!-- Card Principal da Transação -->
    <div class="card p-6 shadow-xl transition-all duration-300">

      <!-- 1. SELEÇÃO DA OPÇÃO -->
      <div class="mb-6">
        <label for="transactionType" class="block text-sm font-medium text-gray-400 mb-2">Selecione o Tipo de Transação</label>
        <select
          id="transactionType"
          name="transactionType"
          [ngModel]="formData().transactionType"
          (ngModelChange)="updateField('transactionType', $event)"
          class="w-full p-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-[var(--color-primary)] focus:border-[var(--color-primary)] text-white appearance-none transition-colors duration-200 transaction-select"
        >
          <option [ngValue]="null" disabled>Escolha uma opção...</option>
          <option value="deposito">Depósito</option>
          <option value="saque">Saque</option>
          <option value="pix">PIX</option>
        </select>
      </div>

      <!-- 2. CAMPOS DINÂMICOS CONFORME A SELEÇÃO -->
      @switch (formData().transactionType) {
        @case ('deposito') {
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <input-field label="Nome do Depositante" [value]="formData().nome" (valueChange)="updateField('nome', $event)" placeholder="Seu nome completo" type="text" />
            <input-field label="Agência" [value]="formData().agencia" (valueChange)="updateField('agencia', $event)" placeholder="Ex: 1234" type="text" />
            <input-field label="Conta" [value]="formData().conta" (valueChange)="updateField('conta', $event)" placeholder="Ex: 56789-0" type="text" />
            <input-field label="Valor do Depósito (R$)" [value]="formData().valor" (valueChange)="updateField('valor', $event)" placeholder="0.00" type="number" />
          </div>
        }
        @case ('saque') {
          <div class="grid grid-cols-1 gap-4">
            <input-field label="Valor do Saque (R$)" [value]="formData().valor" (valueChange)="updateField('valor', $event)" placeholder="0.00" type="number" />
          </div>
        }
        @case ('pix') {
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <input-field label="Chave PIX (e-mail, telefone, CPF/CNPJ)" [value]="formData().chavePix" (valueChange)="updateField('chavePix', $event)" placeholder="Chave do destinatário" type="text" class="sm:col-span-2" />
            <input-field label="Valor do PIX (R$)" [value]="formData().valor" (valueChange)="updateField('valor', $event)" placeholder="0.00" type="number" class="sm:col-span-2" />
          </div>
        }
      }

      <!-- 3. BOTÃO DE SUBMISSÃO (Condicional e Habilitado por Validação) -->
      @if (formData().transactionType) {
        <div class="mt-8 pt-4 border-t border-gray-700">
          <button
            class="btn-primary w-full"
            [disabled]="!isFormValid()"
            (click)="processTransaction()"
          >
            {{ getButtonText() }}
          </button>
        </div>
      }
    </div>
  </div>
</div>